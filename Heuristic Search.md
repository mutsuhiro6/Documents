---
langs: ja-jp
title: 発見的探索手法
tags: AI, fai3, A*探索 
---

発見的探索手法
===
 
* 総当たり手法
* 発見的手法
    * コスト付き探索
    * 最良優先探索
    * A*探索
* 反復改良法
## 完全性と最適性
#### 完全性
解が1つ存在しているときに、それを見つけることが保証されているか。
#### 最適性
互いに異なる解が複数あるときに、最も良い解を見つけるか。

* 幅優先探索 : **完全かつ最適**。
    * *コストがノードの深さに対して非減少の時に限る* 
* 深さ優先探索 : **完全でも最適でもない**。

## コスト付き探索(ダイクストラ)
オペレータの適用の際に生じるコストを考慮
* $g(X)$ : ルートからノード$X$までのコスト(**累積コスト**)。
* $c(X,Y)$ : ノード$X$から$Y$までのコスト。
    * $g(Y)=g(X)+c(X,Y)$
* **最適解** : ルートからゴールノードへのコストが最小になるもの。

### アルゴリズム
*open*は**優先度付きキュー**(priority queue)。
1. *open*にルートノードを加える。
2. *open*が空の時、*探索失敗*、実行終了。
3. *open*から先頭のノード*N*を取り出す。
4. *N*がゴールノードの時、*探索成功*、実行終了。
5. *N*の全ての子ノードを*open*に追加、この時*open*は$g(X)$の小さい順に並び替える。2.へ。

```clike
Dijkstra(){
    priority_queue open;
    add(open, root); //g(X)による優先度付きで追加
    while(1){
        if(isNull?(open)) exit(Failure);
        N = pop(open);
        if(isGoal?(N)) exit(Success);
        for(child : N) add(open, child);
    }
}
```

## 最良優先探索(BFS)
* $h(X)$ : ノード$X$からゴールノードまでのコスト。
* $h'(X)$ : **ヒューリスティック関数**
    * $h(X)$を**推定**する経験的な関数。
### 8パズルによる例
* $h'(X)$を*目標状態と異なる要素の数*、と設定。

### アルゴリズム
ダイクストラにおいて、$g(X)$を$h'(X)$に置き換えたもの。

## A探索
$g(X)$と$h'(X)$の両方を用いる。
* $f(X)$ : トータルコスト
    * $f(X)=g(X)+h(X)$
* $f'(X)$ : トータルコストの**推定値**
    * $f'(X)=g(X)+h'(X)$ 

### アルゴリズム
ダイクストラにおいて、$g(X)$を$f'(X)$に置き換えたもの。

## A\*探索
全てのノード$X$で$h'(X)\leq h(X)$であるようなA探索をA\*探索と呼ぶ。
また、このような性質を持つ$h'(X)$を**許容的なヒューリスティック**と呼ぶ。全てのノード$X$において$f'(X)\leq f(X)$であるから、必ず最適解が求まる(**最適性**)。また、**完全性**は分岐数が無限でない時成立する。

### 最適性の証明(考え方)
#### 前提
* *A* : 最適なゴールノード
* *B* : 任意の準最適なゴールノード
* $g(A)<g(B)$
#### 考え方
*B*に到達することで探索が終了することがない、つまり*B*よりも*A*が先に展開されることを証明(背理法)。

### 完全性の証明
*fai3.pdf page29*参照

### A\*探索の効率最適性
最適かつ完全なアルゴリズムの中でA\*探索は効率最適(**展開ノード数が最小**)である。
#### 証明
$f'(X)<g(A)$を満たす全てのノード$X$を展開しないアルゴリズムは最適でない場合が存在するから。

### 計算量の評価尺度
#### 有効分岐数(effective branch factor) $b^*$
ある問題に対してA\*探索で展開されたノード総数が$N$で解の深さを$d$とした時、深さ$d$の均一の木が$N+1$個のノードを持つための分岐数。

$$N+1=1+b^*+{b^*}^2+\dots +{b^*}^d$$
##### 例
* $N=52,d=5$のとき$b^*=1.92$
* $b^*=1$のとき$d=N$(最速)
* 小さければ小さいほど効率が良い探索である。
* *fai3.pdf page27*参照

## 各手法の完全性、最適性

|          |    最適性        |    完全性   |
|:--------:|:---------------:| :--------: |
|Depth FS  |✖︎                |✖︎           |
|Breast FS |○                |○           |
|Best FS   |✖︎                |✖︎           |
|A Search  |△($h'$が不正確で✖︎)|            |
|A\* Search|○                |○           |
