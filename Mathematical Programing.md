---
lang: ja-jp
title: 数理計画法
tags: 数理計画法
---

# 数理計画法

**目的関数**と、**制約条件**から数理計画問題を定式化し、さまざまな手法を用いることで最適解を導く。

## 線形計画問題

変数の1次の等式または不等式で設定された制約条件のもとで変数の1次関数で与えられた目的関数を最大化および最小化する問題を線形計画問題という。

### 標準形

目的関数: ${\bf c^Tx}\rightarrow$ 最小化
制約条件: ${\bf Ax} = {\bf b},{\bf x}\geq 0$

と表せる定式化を**標準形**と言う。全ての線形計画問題は標準形に書き直せる。

- 目的関数の最大化のとき、目的関数を(-1)倍して最小化問題に読み換える。
- **スラック変数**を導入して制約条件の不等式は等式に書き直す。
- 非負条件のない変数は、非負変数2つを用意し、その差分で定義し直す。

### 線形計画問題の最適解

- 幾何学的解法 
- 基底解
	- 実行可能基底解 

決定変数がn個、独立な等式制約条件がm個の標準形の場合、

- n変数のうち、(n-m)変数が0である解を基底解と呼ぶ
- 最適解は、実行可能基底解のうちの一つ
- 実行可能領域が閉じていない場合、最適解が存在しない場合があり、非有界であると言う。


## シンプレックス法

非基底から基底へ移す変数と、基底から外す変数が決まったら、新しい基底解が最適解であるかを、最適解条件により判定する。また、最適解でない場合、基底を入れ替える。これを繰り返し、最適解を求める。このような作業をシンプレックス法と呼ぶ。

### 手順

1. 初期基底形式を得る。
2. z行の中で負の値が存在しなければ現在の基底解が最適解であるので終わり。
3. 負の値が存在する場合、負の値の列を1つ選ぶ。
4. ピボット列の中の正の係数を持つ行について、基底解の値を係数で割り、最小の値をとる行を選ぶ。
5. ピボット操作を行って、ピボット要素以外のピボット列の要素を0にする。
6. 2.に戻る。


### 基底形式

任意の(n-m)この変数によって、目的関数と残りのm個の変数を書き表すことができる。目的関数を書き表している(n-m)この変数を**非基底変数**と呼び、それ以外のm個の変数を**基底変数**と呼ぶ。  

### 最適解条件

基底形式
	$$
		目的関数: z = {\bf C} + {\bf c'x_N} → 最小化 \\
		制約条件: {\bf A'x_N} + {\bf x_B} = {\bf b'} \\
 		\ \ \ \ \ \ {\bf x} \geq {\bf 0}
	$$
について
  
- 基底解は$\boldsymbol{x_n}=0,\boldsymbol{x_B}=\boldsymbol{b'}$であり、したがって、$b'\geq 0$である時、またその時に限って実行可能基底解。
- $c'\geq 0$ならば、実行可能基底解は最適解。
- $c'\geq 0$でないならば、この基底解は最適解ではない。

### シンタックスタブロー

行に変数名と、その係数を書き、列にはその行に表されている基底変数名をかく。

|   |x<sub>1</sub>|x<sub>2</sub>|x<sub>3</sub>|x<sub>4</sub>| z |   |
|:-:|:-----------:|:------------|:-----------:|:-----------:|:-:|:-:|
|**-z** |     -1      |   -1    |     0       |      2      |-1 | 0 | 
|**x<sub>3</sub>**| 3 |    2    |      1      |      0      | 0 | 12|
|**x<sub>4</sub>**| 1 |    2    |      0      |      1      | 0 | 8 |

#### 性質

1. 基底変数の行と列が交わるところには単位行列、あるいは単位行列の列を適当に入れ替えた行列が現れる。
2. z行の基底変数の列の要素は、全て0となる。
3. 基底解において、基底変数の値は最右列の値になる。基底解が実行可能ならば、最右列は全て非負。
4. 基底会における目的関数の値は、右上端の値の(-1)倍。

### 退化

あるピボット行の際右の要素が0のとき、そのピボット行をいかにz行に足し引きしても目的関数は影響されない。このことを退化と呼ぶ。退化の連続(循環、巡回)が起こると最適解が求まらなくなる。→**Blandの最小添字規則**

### Blandの最小添字規則

ピボット行、ピボット列の候補が複数ある時には変数の添字の小さい方から選択する。


## 2段階シンプレックス法

### 手順

1. 制約条件式の数だけ人為変数を導入し、その和を最小化する補助問題を作る
2. 補助問題をシンプレックス法で解く。目的関数が0にならなかった場合、元の目的関数に実行可能解がなく、終了。
3. 補助問題の最適解に人為変数が含まれる場合、基底の交換をして基底から外す。
4. タブローから人為変数の列を全てのぞいて目的関数を元の問題に置き換える。
5. 各行の定数倍を目的関数の行に加えることにより初期基底形式を得る。
6. 初期基底形式にシンプレックス法を適用に、元の問題を解く。

## 双対問題

主問題Dと双対問題Pは表裏の関係がある。主問題D

$$
目的関数: z = {\bf c^Tx} \rightarrow 最小化 \\
制約条件: {\bf Ax} = {\bf b},\ {\bf x} ≥{\bf 0} 
$$

に対して、双対問題Pは

$$
目的関数: w = {\bf b^Ty} \rightarrow 最大化 \\
制約条件: {\bf A^Ty} ≤ {\bf c}
$$

で表される。

- 弱双対定理
- **双対定理**

## ネットワーク計画法

- 最短路問題
- 最大流問題
- 最小費用流問題
- PERT

### 最短路問題

接点sから接点tまで最短でいくための経路を求める。

- ダイクストラ法

### 最大流問題

接点sから接点tまで最も多く(情報を)流すための経路を求める。

- フロー増加法
- ラベリング法

### 最小費用流問題

グラフに対し、全ての需要量、供給量を満足しつつ、コストを最小にするのにどのような輸送が良いかを求める。

- バサッカー・ゴーウェン法
	- コスト最小を保持しつつ、フローを必要量まで増やす方法
- クライン法
- フロイド・ワーシャル法

### PERT(Program Evaluation and Review Technique)

- アロー・ダイアグラム
	- 最早開始時刻
	- 最遅終了時刻
	- 余裕時間
		- $t_j^l-t_i^e - a_{i,j}$ 
	- 自由余裕時間
		- $t_j^l-t_i^l-a_{i,j}$ 

## 組合せ最適化問題

- 欲張り法
- 分岐限定法
- 動的計画法
- 近似解法
























